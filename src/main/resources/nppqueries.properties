apppath=E:/Hrishi/kryptos/apache-tomcat-7.0.4/webapps/ROOT/
deploymentType=M
DBTYPE=M
siteUrl=http://app-devnpp.rhcloud.com/

PersonService.register=INSERT INTO USER_DETAILS (LOGIN_ID,LOGIN_USR_NAME,LOGIN_USR_PWD,LOGIN_USR_VENDOR_ID,LOGIN_USR_TYPE,LOGIN_USR_EMAIL_ID,LOGIN_USR_ADDR,LOGIN_USR_MOB_NO,LOGIN_USR_CRN_DT,LOGIN_USR_STATUS) \
		VALUES(?,?,?,?,?,?,?,?,?,?)

PersonService.login=SELECT LOGIN_SYS_UNIQID,VENDOR_USER_ID,LOGIN_ID,LOGIN_USR_NAME,LOGIN_USR_VENDOR_ID,LOGIN_USR_TYPE,LOGIN_USR_EMAIL_ID, LOGIN_USR_MOB_NO, LOGIN_USR_ADDR FROM USER_DETAILS WHERE LOGIN_ID= ? AND  LOGIN_USR_PWD = ?

changepassword=UPDATE USER_DETAILS \
			   	SET LOGIN_USER_PWD='@LOGIN_USER_PWD',LOGIN_USR_DEF_PWD_IN='N',LOGIN_USR_LAST_LOGIN_TIME=NOW() \
			   		WHERE LOGIN_USER_ID='@LOGIN_USER_ID'
			   		
generatepassword=UPDATE USER_DETAILS \
					SET LOGIN_USER_PWD='@LOGIN_USER_PWD',LOGIN_USR_DEF_PWD_IN='Y',LOGIN_USR_LAST_LOGIN_TIME=NOW() \
						WHERE LOGIN_USER_ID='@LOGIN_USER_ID'
						
PersonService.loadUserPforile=SELECT LOGIN_ID,LOGIN_USR_NAME,LOGIN_USR_TYPE,LOGIN_USR_EMAIL_ID,LOGIN_USR_ADDR,LOGIN_USR_MOB_NO,LOGIN_USR_STATUS FROM USER_DETAILS \
				 WHERE LOGIN_SYS_UNIQID=?

PersonService.resetPassword= UPDATE USER_DETAILS SET LOGIN_USR_PWD = ? WHERE LOGIN_SYS_UNIQID = ? AND LOGIN_USR_PWD = ?

PersonService.updateUserProfile=UPDATE USER_DETAILS SET LOGIN_USR_NAME = ?, LOGIN_USR_EMAIL_ID = ?, LOGIN_USR_ADDR = ?, LOGIN_USR_MOB_NO = ? WHERE LOGIN_SYS_UNIQID = ?

PersonService.getPendingBills=SELECT BL.GROSS_AMT+SERV_CHRG-COMM_AMT TOTAL_CHARGES, LAST_OS_AMT-PYMT_AMT BALANCE_PAYABLE, \
							BL.GROSS_AMT+SERV_CHRG+LAST_OS_AMT-PYMT_AMT-COMM_AMT TOTAL_PAYABLE \
							FROM @DB_NAME.TR_BILL BL, @DB_NAME.MT_COMPANY C \
							LEFT JOIN @DB_NAME.SYSTEM_PARAMS S ON (S.LOGIN_USR_VENDOR_ID = C.LOGIN_USR_VENDOR_ID) AND S.COND = 'SERV_CHRG' \
							WHERE BL.AGN_CODE = ? \
							AND BL.BILL_DATE = (SELECT MAX(BILL_DATE) FROM @DB_NAME.TR_BILL) \
							AND C.LOGIN_USR_VENDOR_ID='@DB_NAME' AND C.LOGIN_USR_VENDOR_ID = BL.LOGIN_USR_VENDOR_ID 
					
PersonService.getMyPapers=SELECT MAP.PUB_CODE, PUB.PUB_NAME, PS.REC_NO, DATE_FORMAT(PS.START_DT, '%Y-%m-%dT00:00:00.000Z') START_DT, DATE_FORMAT(PS.END_DT, '%Y-%m-%dT00:00:00.000Z') END_DT  \
				FROM @DB_NAME.MT_PUBLICATION PUB, @DB_NAME.MT_AGN_NEWS_PAPER_MAP MAP LEFT JOIN  @DB_NAME.MT_AGN_PAPER_STOP PS \
				ON  PS.AGN_CODE = MAP.AGN_CODE AND  ( (PS.PUB_CODE = MAP.PUB_CODE AND PS.PUB_FLG= 'N') OR PS.PUB_FLG= 'Y' ) \
				AND  PS.PAPER_CONT= 'S' WHERE MAP.PUB_CODE=PUB.PUB_CODE AND MAP.AGN_CODE=?
													
PersonService.getBillTrend=SELECT BILL_NO, CONCAT(SUBSTRING(MONTHNAME(BILL_DATE), 1, 3), '-', YEAR(BILL_DATE)) LABEL, \
		BL.GROSS_AMT+SERV_CHRG+LAST_OS_AMT-PYMT_AMT-COMM_AMT TOTAL_PAYABLE \
		FROM @DB_NAME.TR_BILL BL, @DB_NAME.MT_COMPANY C \
		LEFT JOIN @DB_NAME.SYSTEM_PARAMS S ON (S.LOGIN_USR_VENDOR_ID = C.LOGIN_USR_VENDOR_ID) AND S.COND = 'SERV_CHRG' \
		WHERE BL.AGN_CODE = ? \
		AND C.LOGIN_USR_VENDOR_ID='@DB_NAME' AND C.LOGIN_USR_VENDOR_ID = BL.LOGIN_USR_VENDOR_ID ORDER BY BL.BILL_DATE ASC limit 0, 12
							 
PersonService.getBillForDate=SELECT BL.GROSS_AMT+SERV_CHRG-COMM_AMT TOTAL_CHARGES, LAST_OS_AMT-PYMT_AMT BALANCE_PAYABLE, \
							BL.GROSS_AMT+SERV_CHRG+LAST_OS_AMT-PYMT_AMT-COMM_AMT TOTAL_PAYABLE \
							FROM @DB_NAME.TR_BILL BL, @DB_NAME.MT_COMPANY C \
							LEFT JOIN @DB_NAME.SYSTEM_PARAMS S ON (S.LOGIN_USR_VENDOR_ID = C.LOGIN_USR_VENDOR_ID) AND S.COND = 'SERV_CHRG' \
							WHERE BL.AGN_CODE = ? \
							AND CONCAT(SUBSTRING(MONTHNAME(BL.BILL_DATE), 1, 3), '-', YEAR(BL.BILL_DATE)) = ?  \
							AND C.LOGIN_USR_VENDOR_ID='@DB_NAME' AND C.LOGIN_USR_VENDOR_ID = BL.LOGIN_USR_VENDOR_ID ORDER BY BL.BILL_DATE DESC LIMIT 1;

PersonService.forgotPassword=UPDATE USER_DETAILS SET  PASSTOKEN = ? WHERE LOGIN_USR_EMAIL_ID = ?

PersonService.resetForgotPass=UPDATE USER_DETAILS SET LOGIN_USR_PWD = ? WHERE PASSTOKEN = ?

PersonService.resetForgotPass.Delete=UPDATE USER_DETAILS SET PASSTOKEN = NULL WHERE PASSTOKEN = ?

PersonService.stopPaper.insert=INSERT INTO @DB_NAME.MT_AGN_PAPER_STOP (AGN_CODE, START_DT, END_DT, PUB_FLG, PUB_CODE, PAPER_CONT, MAKER, MAKER_DT, CREATION_DT, STATUS,LOGIN_USR_VENDOR_ID) VALUES \
					(?, ?, ?, 'N', ?, 'S', ?, current_date(), current_date(), 'I',?)
					
PersonService.getMaxBillDate=SELECT MAX(BILL_DATE) FROM @DB_NAME.TR_BILL WHERE BILL_FREQ = 'M'

sms="SELECT ALL USERS FOR WHICH SMS NEED TO BE SENT"

email=SELECT AGN_CODE,AGN_NAME,FILE_NAME,FILE_CONTENT_TYPE,AGN_EMAIL_ID \
		FROM @DB_NAME.GN_PROCESS_INFO P,@DB_NAME.MT_AGENCY A \
				 WHERE P.AGN_CODE=A.AGN_CODE AND STATUS <> 'EMAIL_SENT'

email_status_update=UPDATE @DB_NAME.GN_PROCESS_INFO SET STATUS='@STATUS' WHERE AGN_CODE=\
						(SELECT LOGIN_SYS_UNIQID FROM USER_DETAILS WHERE LOGIN_USER_ID='@LOGIN_USER_ID')

InvalidAccess=UPDATE USER_DETAILS SET LOGIN_USR_INV_LOGIN_ATT_CNT = LOGIN_USR_INV_LOGIN_ATT_CNT+1 \
				WHERE LOGIN_USER_ID='@LOGIN_USER_ID'
				
InvalidAccessCount=SELECT LOGIN_USR_INV_LOGIN_ATT_CNT FROM USER_DETAILS WHERE LOGIN_USER_ID='@LOGIN_USER_ID'

InvalidAccessLockUser=UPDATE USER_DETAILS SET LOGIN_USR_LOCK_IN = 'Y' WHERE LOGIN_USER_ID='@LOGIN_USER_ID'

mycomplaint=INSERT INTO CUSTOMER_COMPLAINTS VALUES(:JSON_OBJECT)

viewcomplaint=SELECT * FROM  CUSTOMER_COMPLAINTS WHERE LOGIN_USER_ID='@LOGIN_USER_ID'


securityChk_Servlet.1=SELECT TOP_MENU_LIST,CNT_CODE_LST FROM @DB_NAME.ST_USER WHERE USR_ID='@USER_ID' AND LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

securityChk_Servlet.2=SELECT VENDOR_ID,VENDOR_NAME,PENDING_EMAIL_COUNT,	EMAIL_COUNT,PENDING_SMS_COUNT,SMS_COUNT, ALERT_CUSTOMER_COUNT,	MAX_CUSTOMER_COUNT FROM VENDOR_DETAILS WHERE VENDOR_ID='@LOGIN_USR_VENDOR_ID'

securityChk_Servlet.3=SELECT * FROM ST_TOP_MENU WHERE MENU_TOP_NAME IN( TOPMENU ) ORDER BY MENU_TOP_ID

securityChk_Servlet.4=SELECT MENU_SIDE_NAME,MENU_SIDE_LNK,ENABLE FROM ST_SIDE_MENU WHERE MENU_TOP_ID=@MENU_TOP_ID ORDER BY MENU_SIDE_ID

securityChk_Servlet.5=SELECT SI.MENU_SIDE_NAME,MENU_SUB_NAME,MENU_SUB_LINK FROM ST_SUB_MENU SB,ST_SIDE_MENU SI WHERE SB.MENU_SIDE_ID=SI.MENU_SIDE_ID ORDER BY SI.MENU_SIDE_NAME,SB.MENU_SUB_ID
securityChk_Servlet.getSysParams=select cond, LOGIN_USR_VENDOR_ID	 from SYSTEM_PARAMS p where p.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' AND INSTALLED_AT != 'N'

GN_SearchDetails.getHolidayDet.1=SELECT PUB_CODE, DATE_FORMAT(HLD_DATE,'%d/%m/%Y') AS HLD_DATE, HLD_VALID_ALLYR FROM @DB_NAME.MT_HOLIDAY WHERE  LOGIN_USR_VENDOR_ID = '@LOGIN_USR_VENDOR_ID'

GN_SearchDetails.getHolidayDet.2=SELECT PUB_CODE, DATE_FORMAT(HLD_DATE,'%d/%m/%Y') AS HLD_DATE, HLD_VALID_ALLYR FROM @DB_NAME.MT_HOLIDAY WHERE  LOGIN_USR_VENDOR_ID = '@LOGIN_USR_VENDOR_ID'

distAppCommonActionServlet.1=SELECT LPAD(NVL(MAX(SUBSTR(SUB_CODE,4))+1,'1'),6,'0') FROM @DB_NAME.MT_SUBPER_DET WHERE LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

distAppCommonActionServlet.2=SELECT NVL(MAX(SERIAL_NO),0) + 1 FROM @DB_NAME.MT_SUBOFFER_DET WHERE SUB_CODE = '@SUB_CODE' AND LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

distAppCommonActionServlet.3=SELECT LPAD(NVL(MAX(SUBSTR(COMP_NO,6))+1,'1'),6,'0') FROM @DB_NAME.MT_SUB_COMP WHERE LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

distAppCommonActionServlet.4=SELECT MAX(CAST(AGN_CODE AS UNSIGNED))+1 FROM @DB_NAME.MT_AGENCY WHERE LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

distAppCommonActionServlet.5=SELECT COUNT(1) FROM @DB_NAME.MT_AGN_PAPER_STOP \
					WHERE START_DT=STR_TO_DATE('@START_DT','%d/%m/%Y') \
					AND AGN_CODE='@AGN_CODE' \
					AND PUB_FLG='PUB_FLG' \ 
					AND IFNULL(PUB_CODE,'ALL')=IFNULL(@PUB_CODE,'ALL') AND LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

distAppCommonActionServlet.6=SELECT STR_TO_DATE('@END_DT','%d/%m/%Y') >= STR_TO_DATE('@START_DT','%d/%m/%Y')

distAppCommonActionServlet.7=SELECT COUNT(1) FROM @DB_NAME.MT_AGN_PAPER_STOP \
					WHERE EFFECT_DT=STR_TO_DATE('@EFFECT_DT','%d/%m/%Y') \
					AND AGN_CODE='@AGN_CODE' \
					AND PUB_FLG='@PUB_FLG' \
					AND IFNULL(PUB_CODE,'ALL')=IFNULL(PUB_CODE,'ALL') \
					AND LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

DistApp_DBProcess.populateDailyRate.1=SELECT DATE_FORMAT(STR_TO_DATE(CONCAT('01/',DATE_FORMAT(DATE_ADD(LAST_DAY(BL.B_DT),INTERVAL 1 DAY),'%M/%Y')),'%d/%M/%Y'),'%d/%m/%Y') AS COPY_ST_DT \
					FROM  (SELECT MAX(BF.BILL_DT) AS B_DT FROM (SELECT DISTINCT B.BILL_FREQ, B.BILL_DATE AS BILL_DT FROM @DB_NAME.TR_BILL B WHERE  LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'\
					 UNION SELECT KEY_CODE AS BILL_FREQ, KEY_NAME AS BILL_DT \
					 FROM @DB_NAME.ST_MAPPINGS WHERE KEY_TYPE = 'BILL_DATE' AND ( LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' OR LOGIN_USR_VENDOR_ID='X')) AS BF  \
						WHERE BILL_FREQ = 'M') AS BL

DistApp_DBProcess.populateDailyRate.2=SELECT SUBSTRING(UPPER(DAYNAME(DATE_FORMAT(STR_TO_DATE('@COPY_START_DT','%d/%m/%Y'),'%Y-%m-01'))),1,3) AS START_DAYNM,\
					SUBSTRING(STR_TO_DATE('@COPY_START_DT','%d/%m/%Y'),-2) AS START_DAY,\
					SUBSTRING(LAST_DAY(STR_TO_DATE('@COPY_START_DT','%d/%m/%Y')),-2)  AS LAST_DAY

DistApp_DBProcess.populateDailyRate.3=SELECT SUBSTRING(UPPER(DAYNAME(DATE_FORMAT(STR_TO_DATE('@COPY_START_DT','%d/%m/%Y'),'%Y-%m-01'))),1,3) AS START_DAYNM,\
					SUBSTR(TO_DATE('@COPY_START_DT','DD/MM/YYYY')) ,-2) AS START_DAY, \
					SUBSTR(LAST_DAY(SYSDATE),-2)  AS LAST_DAY FROM ST_SYSTEM_INFO \
					WHERE TO_CHAR(SYSDATE,'MM/YYYY') =TO_CHAR(TO_DATE('@COPY_START_DT','DD/MM/YYYY'),'MM/YYYY')

DistApp_DBProcess.formDetails=SELECT QUERY FROM ST_FORMDETAILS WHERE FORM_NAME='@FORM_NAME' AND (LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' OR LOGIN_USR_VENDOR_ID='X') 

DistApp_DBProcess.distappCommonUpdtDet.1=SELECT PUB_CODE, COPY_START_DATE, PYMT_MODE, WK_SUP, COPY, AVD_COUPON, COUPON_NO, CPN_ST_DT, CPN_EN_DT, COMM_PER, PUB_RUN, PUB_DAY1, PUB_DAY2, PUB_DT, PUB_DT_ALL_FLG, SERV_CHRG FROM @DB_NAME.MT_AGN_NEWS_PAPER_MAP WHERE LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

DistApp_DBProcess.populateDailySupply.1=SELECT DATE_FORMAT(IF(STR_TO_DATE(DATE_FORMAT(DATE_ADD(LAST_DAY(BL.B_DT),INTERVAL 1 DAY),'%M/%Y'),'%M/%Y') > \
					STR_TO_DATE(SUBSTRING('@COPY_START_DATE',-7),'%M/%Y'), \
					STR_TO_DATE(CONCAT('01/',DATE_FORMAT(DATE_ADD(LAST_DAY(BL.B_DT),INTERVAL 1 DAY),'%M/%Y')),'%d/%M/%Y'), \
					STR_TO_DATE('@COPY_START_DATE','%d/%m/%Y')),'%d/%m/%Y') AS COPY_ST_DT \
					FROM  (SELECT MAX(BF.BILL_DT) AS B_DT FROM \
					(SELECT DISTINCT B.BILL_FREQ, B.BILL_DATE AS BILL_DT \
					FROM @DB_NAME.TR_BILL B WHERE B.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'  \
					UNION SELECT KEY_CODE AS BILL_FREQ, KEY_NAME AS BILL_DT \
					FROM @DB_NAME.ST_MAPPINGS WHERE KEY_TYPE = 'BILL_DATE' AND (LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' OR LOGIN_USR_VENDOR_ID='X')) AS BF \
					WHERE BILL_FREQ = 'M') AS BL 

DistApp_DBProcess.populateDailySupply.2=SELECT SUBSTRING(UPPER(DAYNAME(DATE_FORMAT(STR_TO_DATE('@COPY_START_DT','%d/%m/%Y'),'%Y-%m-01'))),1,3) AS START_DAYNM, \
					SUBSTRING(STR_TO_DATE('@COPY_START_DT','%d/%m/%Y'),-2) AS START_DAY, \
					SUBSTRING(LAST_DAY(STR_TO_DATE('@COPY_START_DT','%d/%m/%Y')),-2)  AS LAST_DAY
					
DistApp_DBProcess.populateDailySupply.3=SELECT SUBSTRING(UPPER(DAYNAME(DATE_FORMAT(STR_TO_DATE('@COPY_START_DT','%d/%m/%Y'),'%Y-%m-01'))),1,3) AS START_DAYNM, \
					SUBSTR(TO_DATE('@COPY_START_DT','DD/MM/YYYY')) ,-2) AS START_DAY, \
					SUBSTR(LAST_DAY(SYSDATE),-2)  AS LAST_DAY FROM ST_SYSTEM_INFO \
					 WHERE TO_CHAR(SYSDATE,'MM/YYYY') =TO_CHAR(TO_DATE('@COPY_START_DT','DD/MM/YYYY'),'MM/YYYY')
					 
DistApp_DBProcess.populateCoupon.1=DELETE FROM @DB_NAME.TR_PAY_COUP WHERE AGN_CODE = '@AGN_CODE' AND PUB_CODE = '@PUB_CODE' AND LOGIN_USER_ID='@LOGIN_USER_ID'

DistApp_DBProcess.populateCoupon.2=SELECT DATE_FORMAT(LAST_DAY(DATE_ADD(STR_TO_DATE('@COPY_START_DATE','%d/%m/%Y'),INTERVAL @COUNT MONTH)),'%d/%m/%Y')

BillExecutor.Rate.update=SELECT RATE_CODE,NAME,WK_SUP,PUB_CODE FROM @DB_NAME.@TABLE_NAME WHERE LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

DistApp_DailyPosting.billGen.1=UPDATE @DB_NAME.TR_DAILY_UNSOLD U SET BILL_DATE = NULL \
					WHERE U.BILL_DATE = STR_TO_DATE('@BILL_DT','%d/%m/%Y') \
					AND U.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'
					AND U.AGN_CODE IN (SELECT AGN_CODE FROM @DB_NAME.MT_AGENCY A WHERE A.BILL_FREQ = '@BILL_FREQ' AND LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID');

DistApp_DailyPosting.billGen.2=UPDATE @DB_NAME.TR_PAYCASH_DETAILS P SET BILL_DATE = NULL \
					WHERE P.BILL_DATE =STR_TO_DATE('@BILL_DT','%d/%m/%Y') \
					AND P.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' \
					AND P.AGN_CODE IN (SELECT AGN_CODE FROM @DB_NAME.MT_AGENCY A WHERE A.BILL_FREQ = '@BILL_FREQ' AND LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID')

DistApp_DailyPosting.billGen.3=UPDATE @DB_NAME.TR_PAY_COUP C SET C.BILL_PROC_DATE = NULL \
					WHERE C.BILL_PROC_DATE =STR_TO_DATE('@BILL_DT','%d/%m/%Y') \
					AND C.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' \
					AND C.AGN_CODE IN (SELECT AGN_CODE FROM @DB_NAME.MT_AGENCY A WHERE A.BILL_FREQ = '@BILL_FREQ' AND LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID')

DistApp_DailyPosting.billGen.4=DELETE FROM @DB_NAME.TR_BILL_DETAIL WHERE BILL_DATE = STR_TO_DATE('@BILL_DT','%d/%m/%Y') \
					AND LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' \
					AND AGN_CODE IN (SELECT AGN_CODE FROM @DB_NAME.MT_AGENCY A WHERE A.BILL_FREQ = '@BILL_FREQ' AND LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID')

DistApp_DailyPosting.billGen.5=SELECT B.AGN_CODE, B.LAST_OS_AMT, B.LAST_SD_AMT FROM @DB_NAME.TR_BILL B \
					WHERE B.BILL_FREQ = '@BILL_FREQ' \
					AND B.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' \
					AND B.BILL_DATE = STR_TO_DATE('@BILL_DT','%d/%m/%Y')

DistApp_DailyPosting.billGen.6=UPDATE @DB_NAME.MT_AGENCY SET AGN_OS_AMT = '@LAST_OS_AMT', TOT_SD_AMT ='@LAST_SD_AMT' \
					WHERE AGN_CODE = '@AGN_CODE' AND LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

DistApp_DailyPosting.billGen.7=DELETE FROM @DB_NAME.TR_BILL WHERE BILL_DATE = STR_TO_DATE('@BILL_DT','%d/%m/%Y') AND \
					LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' AND \
					AGN_CODE IN (SELECT AGN_CODE FROM @DB_NAME.MT_AGENCY A WHERE A.BILL_FREQ = '@BILL_FREQ' AND LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID')

DistApp_DailyPosting.billGen.8=DELETE FROM @DB_NAME.MT_RATE WHERE LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'


DistApp_DailyPosting.billGen.9= INSERT INTO @DB_NAME.MT_RATE \
					SELECT RATE_CODE, NAME, RATE_DAY1, RATE_DAY2, RATE_DAY3, RATE_DAY4, RATE_DAY5, \
					RATE_DAY6, RATE_DAY7, RATE_DAY8, RATE_DAY9, RATE_DAY10, RATE_DAY11, RATE_DAY12, \
					RATE_DAY13, RATE_DAY14, RATE_DAY15, RATE_DAY16, RATE_DAY17, RATE_DAY18, RATE_DAY19, \
					RATE_DAY20, RATE_DAY21, RATE_DAY22, RATE_DAY23, RATE_DAY24, RATE_DAY25, RATE_DAY26, \
					RATE_DAY27, RATE_DAY28, RATE_DAY29, RATE_DAY30, RATE_DAY31, WK_SUP, CREATION_DT, \
					MAKER, MAKER_DT, STATUS, OLD_CODE, REMARKS, PUB_CODE,LOGIN_USR_VENDOR_ID FROM @DB_NAME.MT_RATE_BILL \
					WHERE BILL_DATE = STR_TO_DATE('@BILL_DT','%d/%m/%Y') AND LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

DistApp_DailyPosting.billGen.10=DELETE FROM @DB_NAME.MT_RATE_BILL WHERE BILL_DATE = STR_TO_DATE('@BILL_DT','%d/%m/%Y') AND LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

DistApp_DailyPosting.billGen.11=DELETE FROM @DB_NAME.MT_PURRATE WHERE LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

DistApp_DailyPosting.billGen.12=INSERT INTO @DB_NAME.MT_PURRATE \
					SELECT RATE_CODE, NAME, RATE_DAY1, RATE_DAY2, RATE_DAY3, RATE_DAY4, RATE_DAY5, \
					RATE_DAY6, RATE_DAY7, RATE_DAY8, RATE_DAY9, RATE_DAY10, RATE_DAY11, RATE_DAY12, \
					RATE_DAY13, RATE_DAY14, RATE_DAY15, RATE_DAY16, RATE_DAY17, RATE_DAY18, RATE_DAY19, \
					RATE_DAY20, RATE_DAY21, RATE_DAY22, RATE_DAY23, RATE_DAY24, RATE_DAY25, RATE_DAY26, \
					RATE_DAY27, RATE_DAY28, RATE_DAY29, RATE_DAY30, RATE_DAY31, WK_SUP, CREATION_DT, MAKER, \
					MAKER_DT, STATUS, OLD_CODE, REMARKS, PUB_CODE,LOGIN_USR_VENDOR_ID FROM @DB_NAME.MT_PURRATE_BILL \
					WHERE BILL_DATE = STR_TO_DATE('@BILL_DT','%d/%m/%Y') AND LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

DistApp_DailyPosting.billGen.13=DELETE FROM @DB_NAME.MT_PURRATE_BILL WHERE BILL_DATE = STR_TO_DATE('@BILL_DT','%d/%m/%Y') AND LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

DistApp_DailyPosting.billGen.14=DELETE FROM @DB_NAME.MT_SUPCHRG WHERE LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

DistApp_DailyPosting.billGen.15=INSERT INTO @DB_NAME.MT_SUPCHRG \
					SELECT RATE_CODE, NAME, RATE_DAY1, RATE_DAY2, RATE_DAY3, RATE_DAY4, RATE_DAY5, RATE_DAY6, \
					RATE_DAY7, RATE_DAY8, RATE_DAY9, RATE_DAY10, RATE_DAY11, RATE_DAY12, RATE_DAY13, RATE_DAY14, \
					RATE_DAY15, RATE_DAY16, RATE_DAY17, RATE_DAY18, RATE_DAY19, RATE_DAY20, RATE_DAY21, RATE_DAY22, \
					RATE_DAY23, RATE_DAY24, RATE_DAY25, RATE_DAY26, RATE_DAY27, RATE_DAY28, RATE_DAY29, RATE_DAY30, \
					RATE_DAY31, WK_SUP, CREATION_DT, MAKER, MAKER_DT, STATUS, OLD_CODE, REMARKS, PUB_CODE,LOGIN_USR_VENDOR_ID \
					FROM @DB_NAME.MT_SUPCHRG_BILL \
					WHERE BILL_DATE = STR_TO_DATE('@BILL_DT','%d/%m/%Y') AND LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

DistApp_DailyPosting.billGen.16= DELETE FROM @DB_NAME.MT_SUPCHRG_BILL WHERE BILL_DATE = STR_TO_DATE('@BILL_DT','%d/%m/%Y') AND LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

DistApp_DailyPosting.billGen.17=DELETE FROM @DB_NAME.MT_AGN_NEWS_PAPER_MAP WHERE LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

DistApp_DailyPosting.billGen.18=INSERT INTO @DB_NAME.MT_AGN_NEWS_PAPER_MAP \
					SELECT AGN_CODE, PUB_CODE, COPY_START_DATE, PYMT_MODE, DAY1, DAY2, DAY3, DAY4, DAY5, DAY6, DAY7, DAY8,\
					DAY9, DAY10, DAY11, DAY12, DAY13, DAY14, DAY15, DAY16, DAY17, DAY18, DAY19, DAY20, DAY21, DAY22, DAY23,\
					DAY24, DAY25, DAY26, DAY27, DAY28, DAY29, DAY30, DAY31, CREATION_DT, MAKER, MAKER_DT, STATUS, WK_SUP,\
					COPY, AVD_COUPON, PAPER_CONT, COUPON_NO, CPN_ST_DT, CPN_EN_DT, COMM_PER, PUB_RUN, PUB_DAY1, PUB_DAY2,\
					PUB_DT, PUB_DT_ALL_FLG, SERV_CHRG,LOGIN_USR_VENDOR_ID \
					FROM @DB_NAME.MT_AGN_NEWS_PAPER_BILL \
					WHERE BILL_DATE =STR_TO_DATE('@BILL_DT','%d/%m/%Y') AND LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

DistApp_DailyPosting.billGen.19=DELETE FROM @DB_NAME.MT_AGN_NEWS_PAPER_BILL WHERE BILL_DATE = STR_TO_DATE('@BILL_DT','%d/%m/%Y') AND LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

DistApp_DailyPosting.billGen.20=UPDATE @DB_NAME.ST_BILL SET RESET_IND = 'Y', LAST_BILL_DT = (SELECT MAX(BILL_DATE) FROM @DB_NAME.TR_BILL)  WHERE BILL_FREQ = '@BILL_FREQ' AND LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

DistApp_DailyPosting.billGen.21=UPDATE @DB_NAME.ST_BILL SET RESET_IND = 'N', LAST_BILL_DT = STR_TO_DATE('@BILL_DT','%d/%m/%Y')  WHERE BILL_FREQ = '@BILL_FREQ' AND LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

DistApp_DailyPosting.billGen.22=INSERT INTO @DB_NAME.MT_RATE_BILL SELECT *,STR_TO_DATE('@BILL_DT','%d/%m/%Y') FROM @DB_NAME.MT_RATE WHERE LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

DistApp_DailyPosting.billGen.23=INSERT INTO @DB_NAME.MT_PURRATE_BILL SELECT *,STR_TO_DATE('@BILL_DT','%d/%m/%Y') FROM @DB_NAME.MT_PURRATE WHERE LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

DistApp_DailyPosting.billGen.24=INSERT INTO @DB_NAME.MT_SUPCHRG_BILL SELECT *,STR_TO_DATE('@BILL_DT','%d/%m/%Y') FROM @DB_NAME.MT_SUPCHRG WHERE LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

DistApp_DailyPosting.billGen.25=INSERT INTO @DB_NAME.MT_AGN_NEWS_PAPER_BILL SELECT *,STR_TO_DATE('@BILL_DT','%d/%m/%Y') FROM @DB_NAME.MT_AGN_NEWS_PAPER_MAP WHERE LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

DistApp_DailyPosting.billGen.26=SELECT DATE_FORMAT(IF(START_DT < STR_TO_DATE('@BILL_ST_DT', '%d/%m/%Y'),  STR_TO_DATE('@BILL_ST_DT', '%d/%m/%Y'),START_DT) , '%d/%m/%Y'),DATE_FORMAT(IF(END_DT > STR_TO_DATE('@BILL_DT', '%d/%m/%Y'),STR_TO_DATE('@BILL_DT', '%d/%m/%Y'), END_DT), '%d/%m/%Y'), PUB_FLG, PUB_CODE,AGN_CODE, PAPER_CONT FROM  @DB_NAME.MT_AGN_PAPER_STOP  WHERE END_DT >= STR_TO_DATE('@BILL_ST_DT',  '%d/%m/%Y' ) AND PAPER_CONT='S' AND LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

DistApp_DailyPosting.billGen.27=SELECT IFNULL(MAX(CAST(BILL_NO AS UNSIGNED)),'0') AS MAX_BILL_NO, SUBSTRING(LAST_DAY(STR_TO_DATE('@BILL_DT','%d/%m/%Y')),-2) AS LAST_DAY, DATE_FORMAT(DATE_ADD(STR_TO_DATE('@BILL_DT','%d/%m/%Y'), INTERVAL 1 DAY),'%d/%m/%Y') AS SUP_START_DATE  FROM @DB_NAME.TR_BILL WHERE LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

DistApp_DailyPosting.billGen.28=SELECT A.AGN_CODE, A.RATE_CODE, IFNULL(A.AGN_OS_AMT,0) AS LAST_OS_AMT, SEC_DED_FLG, SEC_DED_TYPE, IFNULL(SEC_DED_VAL,0) AS SEC_DED_VAL, IFNULL(TOT_SD_AMT,0) AS LAST_SD_AMT, SERV_CHRG, LATE_CHRG FROM @DB_NAME.MT_AGENCY A WHERE A.BILL_FREQ = '@BILL_FREQ' AND A.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' 

reortGenToolActionServlet.updateProcessTab.1=SELECT IFNULL(MAX(CAST(PROCESS_ID AS UNSIGNED)),0)+1 FROM GN_PROCESS_INFO WHERE PROCESS_DATE=STR_TO_DATE('@SYS_DT','%d/%m/%Y') AND LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

reortGenToolActionServlet.updateProcessTab.2=INSERT INTO GN_PROCESS_INFO VALUES('@RPT_SEQ','@PROCESS_NAME','STARTED',STR_TO_DATE('@SYS_DT','%d/%m/%Y'),'@FILE','@MAKER','@AGN_CODE','P','APPLICATION/PDF','@LOGIN_USR_VENDOR_ID')

reportGenTool.updateReportData.1=SELECT PUB_BASE_SUP FROM @DB_NAME.MT_PUBLICATION WHERE IF( STRCMP( PUB_OLD_CODE, '' ) AND STRCMP( '@LANG', 'ENGLISH' ) , PUB_OLD_CODE, PUB_NAME ) ='@PUB_NAME' AND LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

reportGenTool.reportDetails.1=SELECT * FROM RP_DETAILS WHERE RP_ID = '@RP_ID' AND LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

reportGenTool.run.1=UPDATE GN_PROCESS_INFO SET PROCESS_STATUS='COMPLETED' WHERE PROCESS_ID='@PROC_ID' AND LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

MT_WKLYAGNSUP=SELECT S.PUB_CODE,P.PUB_NAME,COPY,DATE_FORMAT(COPY_START_DATE,'%d/%m/%Y'),PYMT_MODE, WK_SUP, A.DLV_CODE AS CUST_ADDRESS, \
				COUPON_NO, DATE_FORMAT(CPN_ST_DT,'%d/%m/%Y'), DATE_FORMAT(CPN_EN_DT,'%d/%m/%Y'),AVD_COUPON, S.COMM_PER, \
				S.SERV_CHRG,P.PUB_RUN, P.PUB_DAY1, P.PUB_DAY2,DATE_FORMAT(S.PUB_DT,'%d/%m/%Y') \
				FROM @DB_NAME.MT_AGN_NEWS_PAPER_MAP S,@DB_NAME.MT_PUBLICATION P,@DB_NAME.MT_AGENCY A \
				WHERE A.AGN_CODE=S.AGN_CODE \
				AND A.LOGIN_USR_VENDOR_ID=S.LOGIN_USR_VENDOR_ID \
				AND A.LOGIN_USR_VENDOR_ID=P.LOGIN_USR_VENDOR_ID \
				AND A.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' \
				AND P.PUB_CODE=S.PUB_CODE \
				AND S.AGN_CODE='@AGN_CODE' \
				AND S.STATUS != 'D' ORDER BY 1,3

MT_CUSTPAYMENT.1=(SELECT DATE_FORMAT(BILL_GEN_DT,'%d/%m/%Y') AS \
				BILL_DATE,BILL_AMT,REC_AMOUNT,IFNULL(ADJUST_AMT,0),IF(REC_AMOUNT=0,BILL_AMT,PEND_AMOUNT), \
				PYMT_MODE,CHQ_NO,DATE_FORMAT(CHQ_DATE,'%d/%m/%Y') CHQ_DATE,BANK_NAME,REMARKS,IFNULL(BILL_DATE,'E'), \
				'MOD',DATE_FORMAT(PAY_REC_DT,'%d/%m/%Y') PAY_REC_DT \
				FROM @DB_NAME.TR_PAYCASH_DETAILS P,@DB_NAME.MT_AGENCY A WHERE A.AGN_CODE=P.AGN_CODE \
				AND A.AGN_CODE='@AGN_CODE' \
				AND P.LOGIN_USR_VENDOR_ID=A.LOGIN_USR_VENDOR_ID \
				AND P.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'
				 
MT_CUSTPAYMENT.2=UNION ALL (SELECT DATE_FORMAT(BILL_DATE,'%d/%m/%Y') AS BILL_DATE,OS_AMT,0,0,OS_AMT,'C','','','','','E', 'INP','@SYS_DT' \
				FROM @DB_NAME.TR_BILL P,@DB_NAME.MT_AGENCY A \
				WHERE A.AGN_CODE=P.AGN_CODE \
				AND A.AGN_CODE='@AGN_CODE' \
				AND A.AGN_CODE NOT IN(SELECT AGN_CODE FROM @DB_NAME.TR_PAYCASH_DETAILS C WHERE C.AGN_CODE=P.AGN_CODE AND C.BILL_GEN_DT=P.BILL_DATE AND C.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID') \
				AND P.LOGIN_USR_VENDOR_ID=A.LOGIN_USR_VENDOR_ID \
				AND P.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

MT_CUSTPAYMENTDETAILS=SELECT BILL_NO,PUB_CODE,SUM(TOTAL_AMT),MONTHNAME(BILL_DATE),YEAR(BILL_DATE) \
				FROM @DB_NAME.TR_BILL_DETAIL WHERE AGN_CODE=@AGN_CODE' AND BILL_DATE=STR_TO_DATE('@BILL_DT,'%d/%m/%Y') GROUP BY BILL_NO,PUB_CODE,MONTHNAME(BILL_DATE),YEAR(BILL_DATE)


MT_MULTICUSTPYMT.1=(SELECT A.AGN_CODE,CONCAT_WS('',A.BUILD_NO,A.WING_NO,IFNULL(A.FLAT_NO,A.AGN_NAME)),\
				DATE_FORMAT(BILL_GEN_DT,'%d/%m/%Y') AS BILL_DATE,BILL_AMT,REC_AMOUNT,IFNULL(ADJUST_AMT,0),\
				IF(REC_AMOUNT=0,BILL_AMT,PEND_AMOUNT),PYMT_MODE,CHQ_NO,CHQ_DATE,BANK_NAME,P.REMARKS,\
				IFNULL(BILL_DATE,'E'), 'MOD',DATE_FORMAT(PAY_REC_DT,'%d/%m/%Y'),DEL.NAME,A.ROUTE_CODE,PRIORITY,AGNORDERBY \
				FROM @DB_NAME.TR_PAYCASH_DETAILS P,@DB_NAME.MT_AGENCY A,@DB_NAME.MT_DELIVERY DEL \
				WHERE PEND_AMOUNT > 0 \
				AND P.BILL_GEN_DT = (SELECT MAX(BILL_DATE) FROM @DB_NAME.TR_BILL WHERE AGN_CODE = P.AGN_CODE AND LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID') \
				AND A.AGN_CODE=P.AGN_CODE \
				AND A.DLV_CODE=DEL.DLV_CODE \
				AND A.LOGIN_USR_VENDOR_ID=P.LOGIN_USR_VENDOR_ID \
				AND A.LOGIN_USR_VENDOR_ID=DEL.LOGIN_USR_VENDOR_ID \
				AND P.LOGIN_USR_VENDOR_ID=DEL.LOGIN_USR_VENDOR_ID \
				AND A.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

MT_MULTICUSTPYMT.2=UNION ALL (SELECT A.AGN_CODE,CONCAT_WS('',A.BUILD_NO,A.WING_NO,IFNULL(A.FLAT_NO,A.AGN_NAME)),\
				DATE_FORMAT(BILL_DATE,'%d/%m/%Y') AS BILL_DATE,OS_AMT,0,0,OS_AMT,\
				'C','','','','','E', 'INP','@SYS_DT',DEL.NAME,A.ROUTE_CODE,PRIORITY,AGNORDERBY \
				FROM @DB_NAME.TR_BILL P,@DB_NAME.MT_AGENCY A, @DB_NAME.MT_DELIVERY DEL \
				WHERE A.DLV_CODE=DEL.DLV_CODE \
				AND A.AGN_CODE=P.AGN_CODE \
				AND A.LOGIN_USR_VENDOR_ID=P.LOGIN_USR_VENDOR_ID \
				AND A.LOGIN_USR_VENDOR_ID=DEL.LOGIN_USR_VENDOR_ID \
				AND P.LOGIN_USR_VENDOR_ID=DEL.LOGIN_USR_VENDOR_ID \
				AND A.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' \
				AND A.AGN_CODE NOT IN(SELECT AGN_CODE FROM @DB_NAME.TR_PAYCASH_DETAILS C WHERE C.AGN_CODE=P.AGN_CODE AND C.BILL_GEN_DT=P.BILL_DATE AND C.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID') \
				AND P.BILL_DATE = (SELECT MAX(BILL_DATE) FROM @DB_NAME.TR_BILL WHERE AGN_CODE = P.AGN_CODE AND LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID')

MT_DISTENTRY=(SELECT PUB.PUB_NAME,SUM(IF(CTG_TYPE='C',IF(PUB.COUPON_COPY_FLAG='Y',IF(PYMT_MODE='CASH',DAY@FIRST_DAY,0),DAY@FIRST_DAY),0)), \
				SUM(IF(CTG_TYPE='S',IF(PUB.COUPON_COPY_FLAG='Y',IF(PYMT_MODE='CASH',DAY@FIRST_DAY,0),DAY@FIRST_DAY),0)), \
				SUM(IF(PUB.COUPON_COPY_FLAG='Y',IF(PYMT_MODE='CASH',DAY@FIRST_DAY,0),DAY@FIRST_DAY)),\
				IFNULL((SELECT RATE_DAY@FIRST_DAY FROM @DB_NAME.MT_PURRATE RT WHERE RT.PUB_CODE=PUB.PUB_CODE),0),\
				SUM(IF( PUB.COUPON_COPY_FLAG='Y',IF( PYMT_MODE='CASH',DAY@FIRST_DAY,0),DAY@FIRST_DAY))*IFNULL((SELECT RATE_DAY@FIRST_DAY FROM @DB_NAME.MT_PURRATE RT WHERE RT.PUB_CODE=PUB.PUB_CODE AND RT.RATE_CODE=AGN.RATE_CODE),0), \
				'0', \
				'0', \
				SUM(IF( PUB.COUPON_COPY_FLAG='Y',IF( PYMT_MODE='CASH',DAY@FIRST_DAY,0),DAY@FIRST_DAY))*IFNULL((SELECT RATE_DAY@FIRST_DAY FROM @DB_NAME.MT_PURRATE RT WHERE RT.PUB_CODE=PUB.PUB_CODE AND RT.RATE_CODE=AGN.RATE_CODE),0), \
				MAP.PUB_CODE, \
				'INP', \
				SUM(IF(PUB.COUPON_COPY_FLAG='Y',IF(PYMT_MODE='COUPON',DAY@FIRST_DAY,0),0)) \
				FROM @DB_NAME.MT_AGN_NEWS_PAPER_MAP MAP,@DB_NAME.MT_AGENCY AGN,@DB_NAME.MT_CATEGORY CAT, @DB_NAME.MT_PUBLICATION PUB WHERE MAP.AGN_CODE=AGN.AGN_CODE \
				AND AGN.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' \
				AND AGN.LOGIN_USR_VENDOR_ID=CAT.LOGIN_USR_VENDOR_ID \
				AND AGN.LOGIN_USR_VENDOR_ID=PUB.LOGIN_USR_VENDOR_ID \
				AND AGN.LOGIN_USR_VENDOR_ID=MAP.LOGIN_USR_VENDOR_ID \
				AND CAT.LOGIN_USR_VENDOR_ID=AGN.LOGIN_USR_VENDOR_ID \
				AND AGN.CTG_CODE=CAT.CTG_CODE AND MAP.PUB_CODE=PUB.PUB_CODE AND PUB.DIST_CD='@DIST_CODE' \
				AND MAP.PUB_CODE NOT IN(SELECT DIST.PUB_CODE FROM @DB_NAME.MT_DISTENTRY DIST WHERE DIST.PUB_CODE=MAP.PUB_CODE \
				AND DIST.DIST_CD=PUB.DIST_CD AND PUB.DIST_CD='@DIST_CODE' AND DIST.SUP_DT=STR_TO_DATE('@SUP_DT','%d/%m/%Y') AND LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID') \
				GROUP BY MAP.PUB_CODE HAVING SUM(DAY@FIRST_DAY) > 0) \
				UNION (SELECT PUB.PUB_NAME,LINE_COPY,STALL_COPY,TOTAL,PUR_RT,TOT_AMT,RET_COPY,TOT_RET_AMT,PAY_AMT,DIST.PUB_CODE,'MOD',FREE_COPY \
				FROM @DB_NAME.MT_DISTENTRY DIST, @DB_NAME.MT_PUBLICATION PUB WHERE \
				DIST.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' \
				AND DIST.LOGIN_USR_VENDOR_ID=PUB.LOGIN_USR_VENDOR_ID \
				AND DIST.PUB_CODE=PUB.PUB_CODE AND DIST.DIST_CD=PUB.DIST_CD AND PUB.DIST_CD='@DIST_CODE' \
				AND DIST.SUP_DT=STR_TO_DATE('@SUP_DT','%d/%m/%Y') ) ORDER BY 4 DESC

MT_AGENCY=SELECT COUNT(1) FROM @DB_NAME.MT_AGENCY WHERE LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

MT_AGENCYSUPPLY.1=SELECT COUNT(1) FROM @DB_NAME.MT_AGN_NEWS_PAPER_MAP WHERE LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

MT_AGENCYSUPPLY.2=SELECT SUM(DAY@CUR_DAY) FROM @DB_NAME.MT_AGN_NEWS_PAPER_MAP WHERE LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'

MT_AGENCYSUPPLY.3=SELECT S.PUB_CODE,P.PUB_NAME,COPY,DATE_FORMAT(COPY_START_DATE,'%d/%m/%Y'),PYMT_MODE, WK_SUP, COUPON_NO, DATE_FORMAT(CPN_ST_DT,'%d/%m/%Y'), \
				DATE_FORMAT(CPN_EN_DT,'%d/%m/%Y'), AVD_COUPON, P.PUB_RUN, P.PUB_DAY1, \
				P.PUB_DAY2,S.COMM_PER,S.SERV_CHRG,DATE_FORMAT(S.PUB_DT,'%d/%m/%Y') \
				FROM @DB_NAME.MT_AGN_NEWS_PAPER_MAP S,@DB_NAME.MT_PUBLICATION P,@DB_NAME.MT_AGENCY A, @DB_NAME.MT_CATEGORY C \
				WHERE C.CTG_CODE = A.CTG_CODE AND A.AGN_CODE=S.AGN_CODE AND P.PUB_CODE=S.PUB_CODE AND S.AGN_CODE='@AGN_CODE' AND \
				S.STATUS != 'D' AND A.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' \
				AND P.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' \
				AND P.LOGIN_USR_VENDOR_ID=A.LOGIN_USR_VENDOR_ID \
				AND P.LOGIN_USR_VENDOR_ID=C.LOGIN_USR_VENDOR_ID \
				AND P.LOGIN_USR_VENDOR_ID=S.LOGIN_USR_VENDOR_ID 

MT_AGNSUPSEARCH=SELECT S.PUB_CODE,P.PUB_NAME,S.EDT_CODE,E.EDT_NAME,A.STATUS \
				FROM @DB_NAME.MT_AGENCY A,@DB_NAME.MT_AGENCY_SUPPLY S,@DB_NAME.MT_PUBLICATION P,@DB_NAME.MT_EDITION E \
				WHERE A.AGN_CODE=S.AGN_CODE AND P.PUB_CODE=S.PUB_CODE AND E.EDT_CODE=S.EDT_CODE AND A.AGN_CODE='@AGN_CODE' \
				AND P.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' \
				AND P.LOGIN_USR_VENDOR_ID=A.LOGIN_USR_VENDOR_ID \
				AND P.LOGIN_USR_VENDOR_ID=E.LOGIN_USR_VENDOR_ID \
				AND P.LOGIN_USR_VENDOR_ID=S.LOGIN_USR_VENDOR_ID 

MT_BASESUPSEARCHRES=SELECT N.PUB_CODE,P.PUB_NAME FROM @DB_NAME.MT_AGN_NEWS_PAPER_MAP N,@DB_NAME.MT_PUBLICATION P,@DB_NAME.MT_AGENCY A \
				WHERE N.AGN_CODE=A.AGN_CODE AND N.PUB_CODE=P.PUB_CODE AND N.STATUS != 'D' AND N.AGN_CODE ='@AGN_CODE' \
				AND P.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' \
				AND P.LOGIN_USR_VENDOR_ID=A.LOGIN_USR_VENDOR_ID \
				AND P.LOGIN_USR_VENDOR_ID=N.LOGIN_USR_VENDOR_ID \

MT_BASESUPSEARCHVEW=SELECT DATE_FORMAT(START_DT,'%d/%m/%Y') AS START_DT, DATE_FORMAT(END_DT ,'%d/%m/%Y') AS END_DT ,\
				PUB_FLG,IFNULL(PUB_CODE,''),IFNULL(PAPER_CONT,''), IF(START_DT> LAST_BILL_DT, 'E','R'),REC_NO FROM @DB_NAME.MT_AGN_PAPER_STOP S, @DB_NAME.ST_BILL B WHERE \
				AGN_CODE = '@AGN_CODE' \
				AND B.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' \
				AND B.LOGIN_USR_VENDOR_ID=S.LOGIN_USR_VENDOR_ID 

MT_BASESUPSEARCHVEWOFF=SELECT IFNULL(DATE_FORMAT(START_DT,'%d/%m/%Y'),'') AS START_DT, \
				IFNULL(DATE_FORMAT(END_DT ,'%d/%m/%Y'),'') AS END_DT , \
				S.PUB_FLG,IFNULL(S.PUB_CODE,''), IFNULL(S.PAPER_CONT,''), \
				IF(START_DT> LAST_BILL_DT OR EFFECT_DT> LAST_BILL_DT, 'E','R'),REC_NO, \
				IFNULL(DATE_FORMAT(EFFECT_DT ,'%d/%m/%Y'),''),P.PUB_NAME \
				FROM @DB_NAME.ST_BILL B, @DB_NAME.MT_AGN_PAPER_STOP S \
				LEFT JOIN @DB_NAME.MT_PUBLICATION P ON S.PUB_CODE=P.PUB_CODE \
				AND S.LOGIN_USR_VENDOR_ID=P.LOGIN_USR_VENDOR_ID \
				WHERE AGN_CODE = '@AGN_CODE' \
				AND B.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' \ 
				AND S.LOGIN_USR_VENDOR_ID=B.LOGIN_USR_VENDOR_ID \
				ORDER BY IFNULL(START_DT,EFFECT_DT) DESC 

MT_COUPONADD=SELECT DISTINCT P.PUB_CODE FROM \
				@DB_NAME.MT_PUBLICATION P,@DB_NAME.MT_AGENCY A, @DB_NAME.MT_AGN_NEWS_PAPER_MAP PM, \
				@DB_NAME.TR_BILL_DETAIL B LEFT OUTER JOIN @DB_NAME.TR_PAY_COUP C ON (B.AGN_CODE =C.AGN_CODE AND B.PUB_CODE = C.PUB_CODE AND B.BILL_DATE = C.BILL_DATE) \
				WHERE B.PUB_CODE=P.PUB_CODE \
				AND PM.PUB_CODE = P.PUB_CODE \
				AND PM.AGN_CODE = A.AGN_CODE \
				AND  B.PYMT_MODE = 'COUPON' \
				AND A.AGN_CODE=B.AGN_CODE \
				AND B.AGN_CODE='@AGN_CODE' \
				AND P.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' \
				AND P.LOGIN_USR_VENDOR_ID=A.LOGIN_USR_VENDOR_ID \
				AND P.LOGIN_USR_VENDOR_ID=PM.LOGIN_USR_VENDOR_ID \
				AND P.LOGIN_USR_VENDOR_ID=B.LOGIN_USR_VENDOR_ID 

MT_COUPONDETAILS=SELECT PUB_NAME,DATE_FORMAT(B.BILL_DATE,'%d/%m/%Y'),P.PUB_CODE,DATE_FORMAT(RCD_DATE,'%d/%m/%Y'), COUPON_NO, \
				DATE_FORMAT(CPN_ST_DT,'%d/%m/%Y'), DATE_FORMAT(CPN_EN_DT,'%d/%m/%Y') \
				FROM @DB_NAME.MT_PUBLICATION P,@DB_NAME.MT_AGENCY A, @DB_NAME.MT_AGN_NEWS_PAPER_MAP PM, \
				@DB_NAME.TR_BILL_DETAIL B LEFT OUTER JOIN @DB_NAME.TR_PAY_COUP C ON (B.AGN_CODE = C.AGN_CODE AND B.PUB_CODE = C.PUB_CODE AND B.BILL_DATE = C.BILL_DATE) \
				WHERE B.PUB_CODE=P.PUB_CODE AND PM.PUB_CODE = P.PUB_CODE \
				AND PM.AGN_CODE = A.AGN_CODE \
				AND  B.PYMT_MODE = 'COUPON' \
				AND A.AGN_CODE=B.AGN_CODE \
				AND B.AGN_CODE='@AGN_CODE' \
				AND P.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' \
				AND P.LOGIN_USR_VENDOR_ID=A.LOGIN_USR_VENDOR_ID \
				AND P.LOGIN_USR_VENDOR_ID=PM.LOGIN_USR_VENDOR_ID \
				AND P.LOGIN_USR_VENDOR_ID=B.LOGIN_USR_VENDOR_ID 

MT_COUPONVIEW=SELECT DISTINCT PUB_CODE FROM @DB_NAME.TR_PAY_COUP C,@DB_NAME.MT_AGENCY A WHERE \
				A.AGN_CODE=C.AGN_CODE AND A.AGN_CODE='@AGN_CODE' \
				AND C.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' \
				AND C.LOGIN_USR_VENDOR_ID=A.LOGIN_USR_VENDOR_ID \

MT_COUPONVIEWDETAILS=SELECT DATE_FORMAT(BILL_DATE,'%d/%m/%Y'),DATE_FORMAT(RCD_DATE,'%d/%m/%Y'),RCVR, COUPON_NO,DATE_FORMAT(BILL_PROC_DATE,'%d/%m/%Y') \
				FROM @DB_NAME.TR_PAY_COUP B,@DB_NAME.MT_PUBLICATION P,@DB_NAME.MT_AGENCY A, @DB_NAME.MT_AGN_NEWS_PAPER_MAP PM \
				WHERE B.PUB_CODE=P.PUB_CODE \
				AND PM.PUB_CODE = P.PUB_CODE \
				AND PM.AGN_CODE = A.AGN_CODE \
				AND A.AGN_CODE=B.AGN_CODE \
				AND B.AGN_CODE='@AGN_CODE' \
				AND P.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' \
				AND P.LOGIN_USR_VENDOR_ID=A.LOGIN_USR_VENDOR_ID \
				AND P.LOGIN_USR_VENDOR_ID=PM.LOGIN_USR_VENDOR_ID \
				AND P.LOGIN_USR_VENDOR_ID=B.LOGIN_USR_VENDOR_ID 

DistApp_DBProcess.formDetails.MT_AGENCY=SELECT DISTINCT A.CTG_CODE,AGNORDERBY, IFNULL(CG.CTG_NAME,'') AS CTG_CODEDESC, A.AGN_CODE, A.AGN_NAME, A.AGN_OLD_CODE, A.AGN_MAR_NAME, A.ROUTE_CODE, IFNULL(RT.NAME,'') AS ROUTE_CODEDESC,A.DLV_CODE, IFNULL(D.NAME,'') AS DLV_CODEDESC, A.BUILD_NO, A.WING_NO, A.FLAT_NO, A.AGN_ADD1, A.AGN_ADD2, A.AREA_CODE, IFNULL(AR.AREA_NAME,'') AS AREA_CODEDESC, A.CITY, IFNULL(CT.KEY_NAME,'') AS CITYDESC, A.AGN_ADD_PIN,A.AGN_TEL, A.AGN_FAX, A.AGN_MOB, DATE_FORMAT(A.SUS_DT,'%d/%m/%Y') AS SUS_DT,  DATE_FORMAT(A.REOPEN_DT,'%d/%m/%Y') AS REOPEN_DT, A.BILL_FREQ, IFNULL(B.KEY_NAME,'') AS BILL_FREQDESC, A.AGN_OS_AMT, A.RATE_CODE,IFNULL(R.NAME,'') AS RATE_CODEDESC, A.COMM_CODE, SEC_DED_FLG, SEC_DED_TYPE, IFNULL(A.SEC_DED_VAL,0) AS SEC_DED_VAL, A.SERV_CHRG,A.LATE_CHRG  \
					FROM @DB_NAME.MT_AGENCY A \
					JOIN @DB_NAME.MT_CATEGORY CG ON A.CTG_CODE = CG.CTG_CODE \
					LEFT JOIN @DB_NAME.MT_AREA AR ON A.AREA_CODE = AR.AREA_CODE \
					JOIN @DB_NAME.MT_DELIVERY D ON A.DLV_CODE = D.DLV_CODE \
					JOIN @DB_NAME.MT_ROUTE RT ON A.ROUTE_CODE = RT.ROUTE_CODE \
					JOIN @DB_NAME.ST_MAPPINGS CT ON CT.KEY_TYPE = 'MH' AND A.CITY = CT.KEY_CODE \
					JOIN @DB_NAME.MT_RATE R ON A.RATE_CODE = R.RATE_CODE \
					JOIN @DB_NAME.ST_MAPPINGS B ON B.KEY_TYPE = 'BILL_FREQ' AND A.BILL_FREQ = B.KEY_CODE \
					WHERE  A.DLV_CODE = D.DLV_CODE  \
					AND A.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' AND 
					  
DistApp_DBProcess.formDetails.MT_AGENCYVEW= SELECT AGN_CODE,AGNORDERBY,AGN_NAME,AGN_OLD_CODE,A.CTG_CODE,AGN_MAR_NAME,A.DLV_CODE,BUILD_NO,WING_NO,FLAT_NO,AGN_ADD1,AGN_ADD2,A.AREA_CODE,A.CITY,A.COUNTRY,A.STATE,A.ROUTE_CODE,AGN_ADD_PIN,AGN_TEL,AGN_MOB,AGN_FAX,SUS_REOP_FLG,SUS_DT,REOPEN_DT,AGN_OS_AMT,BILL_FREQ,A.RATE_CODE,A.COMM_CODE,SEC_DED_FLG,SEC_DED_TYPE,SEC_DED_VAL,TOT_SD_AMT,LATE_CHRG \
					 FROM @DB_NAME.MT_AGENCY A LEFT JOIN @DB_NAME.MT_AREA A1 ON A.AREA_CODE=A1.AREA_CODE,@DB_NAME.MT_CATEGORY C,@DB_NAME.MT_DELIVERY D,@DB_NAME.MT_ROUTE R,@DB_NAME.MT_RATE RA,@DB_NAME.MT_COMMISSION CO,@DB_NAME.ST_MAPPINGS M \
					 WHERE A.CTG_CODE=C.CTG_CODE \
					 AND A.DLV_CODE=D.DLV_CODE \
					 AND A.ROUTE_CODE=R.ROUTE_CODE \
					 AND A.RATE_CODE=RA.RATE_CODE \
					 AND A.COMM_CODE=CO.COMM_CODE \
					 AND A.CITY = M.KEY_CODE \
					 AND A.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' AND 
					   
DistApp_DBProcess.formDetails.MT_AGN_NEWS_PAPER_MAP=SELECT PUB_NAME, AGN_CODE, N.PUB_CODE,  DATE_FORMAT( COPY_START_DATE, '%d/%m/%Y' ) AS COPY_START_DATE, PYMT_MODE, DAY1,  DAY2,  DAY3,  DAY4,  DAY5,  DAY6, \
					DAY7,  DAY8,  DAY9,  DAY10,  DAY11,  DAY12,  DAY13,  DAY14,  DAY15,  DAY16,  DAY17,  DAY18, \
					DAY19,  DAY20,  DAY21,  DAY22,  DAY23,  DAY24,  DAY25,  DAY26,  DAY27,  DAY28,  DAY29,  DAY30,  DAY31,  N.STATUS, \
					DAYOFWEEK(DATE_ADD(IFNULL(LAST_BILL_DT, CUTOVER_BILL_DT), INTERVAL 1 DAY))  AS FIRSTDAY, WK_SUP, COPY, PAPER_CONT,COUPON_NO, DATE_FORMAT(CPN_ST_DT,'%d/%m/%Y') AS CPN_ST_DT, DATE_FORMAT(CPN_EN_DT,'%d/%m/%Y') AS CPN_EN_DT, COMM_PER,AVD_COUPON ,N.PUB_RUN,N.PUB_DAY1,N.PUB_DAY2,DATE_FORMAT(N.PUB_DT,'%d/%m/%Y') ,N.PUB_DT_ALL_FLG,SERV_CHRG \
					FROM @DB_NAME.MT_PUBLICATION P, @DB_NAME.MT_AGN_NEWS_PAPER_MAP N, @DB_NAME.ST_BILL \
					WHERE P.PUB_CODE = N.PUB_CODE AND N.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' AND 
					 
DistApp_DBProcess.formDetails.MT_AREA=SELECT AREA_CODE, AREA_NAME, A.OLD_CODE, A.AREA_MAR_NAME, A.RGN_CODE, R.RGN_NAME AS RGN_CODEDESC, \
					A.CNT_CODE, C.CNT_NAME AS CNT_CODEDESC, A.CITY,  A.AREA_MNGR, \
					E.NAME AS AM_CODEDESC, AREA_MGRTEL, A.REMARKS,AREA_ADD_PIN \
					FROM @DB_NAME.MT_AREA A \
					LEFT JOIN @DB_NAME.MT_CENTER C ON A.CNT_CODE = C.CNT_CODE \
					LEFT JOIN @DB_NAME.MT_EXECUTIVE E ON A.AREA_MNGR = E.EXEC_CODE AND 'A' = E.TYPE \
					WHERE A.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' AND  

DistApp_DBProcess.formDetails.MT_AREAVIEW=SELECT AREA_CODE, AREA_NAME, A.OLD_CODE, A.AREA_MAR_NAME, A.CITY,  A.AREA_MNGR, \
					E.NAME AS AM_CODEDESC, AREA_MGRTEL, A.REMARKS,AREA_ADD_PIN \
					FROM @DB_NAME.MT_AREA A \
					LEFT JOIN @DB_NAME.MT_EXECUTIVE E ON A.AREA_MNGR = E.EXEC_CODE AND 'A' = E.TYPE \
					WHERE A.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' AND 
					  
DistApp_DBProcess.formDetails.MT_CATEGORY=SELECT CTG_CODE, CTG_NAME, CTG_TYPE, IF(CTG_PAID_FLG='F',CTG_PAID_FLG,NULL) AS CTG_PAID_FLG, IF(CTG_PAID_FLG='P',CTG_PAID_FLG,NULL) AS CTG_PAID_FLG1, SERV_CHRG, COMM_PER FROM @DB_NAME.MT_CATEGORY WHERE LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' AND 
  
DistApp_DBProcess.formDetails.MT_CENTER=SELECT CNT_CODE,CNT_NAME,CNT_OLD_CODE,CM.CMP_CODE,CNT_ADD1,CNT_ADD2,CM.CITY,CM.STATE,CM.COUNTRY,CNT_ADD_PIN,CNT_TEL,CNT_FAX,CNT_VALID_FLG,CNT_DISTR_FLG,CNT_EDITN_FLG,CNT_REMARKS,CM.CREATION_DT,CM.MAKER,CM.MAKER_DT,CM.STATUS,MTC.CMP_NAME AS CMP_CODEDESC,MPC.KEY_NAME AS COUNTRYDESC,MPS.KEY_NAME AS STATEDESC,MC.KEY_NAME AS CITYDESC \
					FROM @DB_NAME.MT_CENTER CM \
					JOIN @DB_NAME.MT_COMPANY MTC ON CM.CMP_CODE=MTC.CMP_CODE \ 
					LEFT JOIN @DB_NAME.ST_MAPPINGS MPC ON CM.COUNTRY=MPC.KEY_CODE AND 'COUNTRY' = MPC.KEY_TYPE \
					LEFT JOIN @DB_NAME.ST_MAPPINGS MPS ON CM.STATE=MPS.KEY_CODE AND CM.COUNTRY = MPS.KEY_TYPE \
					LEFT JOIN @DB_NAME.ST_MAPPINGS MC ON CM.CITY=MC.KEY_CODE AND CM.STATE = MC.KEY_TYPE \
					WHERE CM.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' AND 
					  
DistApp_DBProcess.formDetails.MT_COMMISSION=SELECT * FROM @DB_NAME.MT_COMMISSION WHERE LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' AND 
  
DistApp_DBProcess.formDetails.MT_COMPANY=SELECT CMP_CODE,CMP_NAME,CMP_SHORTNM,CMP_ADD1,CMP_ADD2,STATE,CITY,COUNTRY,CMP_ADD_PIN,CMP_TEL,CMP_FAX,CMP_WEBADD,CMP_BHNM,CMP_CONNM,CMP_CONTEL,CMP_CONEMAIL,CMP_REMARKS,CMP_REMARKS2,CMP_REMARKS3,CMP_REMARKS4,BILL_HEADER,CREATION_DT,MAKER,MAKER_DT,IF(MPC.KEY_NAME=1,MPC.KEY_NAME,MPC.KEY_NAME) AS COUNTRYDESC,IF(MPS.KEY_NAME=1,MPS.KEY_NAME,MPS.KEY_NAME) AS STATEDESC,IF(MC.KEY_NAME=1,MC.KEY_NAME,MC.KEY_NAME) AS CITYDESC,STATUS \
					FROM @DB_NAME.MT_COMPANY CM \
					LEFT JOIN @DB_NAME.ST_MAPPINGS MPC ON CM.COUNTRY=MPC.KEY_CODE AND 'COUNTRY' = MPC.KEY_TYPE \
					LEFT JOIN @DB_NAME.ST_MAPPINGS MPS ON CM.STATE=MPS.KEY_CODE AND CM.COUNTRY = MPS.KEY_TYPE \
					LEFT JOIN @DB_NAME.ST_MAPPINGS MC ON CM.CITY=MC.KEY_CODE AND CM.STATE = MC.KEY_TYPE \
					WHERE CM.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' AND 
					  
DistApp_DBProcess.formDetails.MT_DELIVERY=SELECT DLV_CODE, D.NAME, D.MAR_NAME,TYPE, T.KEY_NAME AS TYPEDESC, D.AREA_CODE, \
					A.AREA_NAME AS AREA_CODEDESC,D.CITY,CT.KEY_NAME AS CITYDESC, D.ROUTE_CODE, \
					R.NAME AS ROUTE_CODEDESC, PRIORITY, D.REMARKS \
					FROM @DB_NAME.MT_DELIVERY D \
					JOIN @DB_NAME.ST_MAPPINGS T ON D.TYPE = T.KEY_CODE AND T.KEY = 'DLV_TYPE' \
					JOIN @DB_NAME.MT_AREA A ON D.AREA_CODE=A.AREA_CODE \
					JOIN @DB_NAME.MT_ROUTE R ON D.ROUTE_CODE = R.ROUTE_CODE \ 
					LEFT JOIN @DB_NAME.ST_MAPPINGS CT ON D.CITY = CT.KEY_CODE \
					WHERE D.STATUS!='D' AND D.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' AND 
					  
DistApp_DBProcess.formDetails.MT_DELIVERYVIEW=SELECT DLV_CODE, D.NAME, D.MAR_NAME, \
					TYPE , IFNULL(T.KEY_NAME,0) AS TYPEDESC, D.AREA_CODE, IFNULL( A.AREA_NAME, 0) AS AREA_CODEDESC, D.CITY, IFNULL( CT.KEY_NAME, 0) AS CITYDESC, D.ROUTE_CODE, IFNULL( R.NAME,0) AS ROUTE_CODEDESC, PRIORITY, D.REMARKS \
					FROM @DB_NAME.MT_DELIVERY D \
					JOIN @DB_NAME.MT_AREA A ON D.AREA_CODE = A.AREA_CODE \
					JOIN @DB_NAME.MT_ROUTE R ON D.ROUTE_CODE = R.ROUTE_CODE \
					JOIN @DB_NAME.ST_MAPPINGS T ON D.TYPE = T.KEY_CODE \
					AND T.KEY_TYPE = 'DLV_TYPE' \
					RIGHT JOIN @DB_NAME.ST_MAPPINGS CT ON D.CITY = CT.KEY_CODE \
					WHERE D.STATUS != 'D' \
					AND D.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' AND 
					  
DistApp_DBProcess.formDetails.MT_EXECUTIVE=SELECT E.EXEC_CODE, E.NAME, E.OLD_CODE, E.TYPE,T.KEY_NAME AS TYPEDESC, E.ADD1, E.ADD2, E.TEL, E.MOB, E.AREA, \
					A.AREA_NAME AS AREADESC, E.AM_CODE,EA.NAME AS AM_CODEDESC, E.RM_CODE,ER.NAME AS RM_CODEDESC, \
					E.ZM_CODE,EZ.NAME AS ZM_CODEDESC, E.TRGT, E.TRGT_ACH \
					FROM @DB_NAME.MT_EXECUTIVE E \
					JOIN @DB_NAME.ST_MAPPINGS T ON T.KEY = 'EXEC_TYPE' AND T.KEY_CODE = E.TYPE \
					JOIN @DB_NAME.MT_AREA A ON E.AREA = A.AREA_CODE \
					LEFT JOIN @DB_NAME.MT_EXECUTIVE EA ON E.AM_CODE = EA.EXEC_CODE AND 'A' = EA.TYPE \
					LEFT JOIN @DB_NAME.MT_EXECUTIVE ER ON E.RM_CODE = ER.EXEC_CODE AND 'R' = ER.TYPE \
					LEFT JOIN @DB_NAME.MT_EXECUTIVE EZ ON E.ZM_CODE = EZ.EXEC_CODE AND 'Z' = EZ.TYPE \
					WHERE E.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' AND  
					  
DistApp_DBProcess.formDetails.MT_HOLIDAY=SELECT DATE_FORMAT(HLD_DATE,'%d/%m/%Y') AS HLD_DATE, HLD_DESC, HLD_VALID_ALLYR, HLD_TYPE, H.PUB_CODE, P.PUB_NAME AS PUB_CODEDESC \
					FROM @DB_NAME.MT_HOLIDAY H \
					LEFT JOIN @DB_NAME.MT_PUBLICATION P ON H.PUB_CODE = P.PUB_CODE \
					WHERE H.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' AND 
					  
DistApp_DBProcess.formDetails.MT_PUBLICATION=SELECT PUB_CODE, PUB_NAME,MP.DIST_CD,PUB_OLD_CODE, MP.CMP_CODE,PUB_ADD1, PUB_ADD2,MP.STATE, MP.CITY,MP.COUNTRY, PUB_ADD_PIN,PUB_TEL, PUB_FAX,PUB_WEBADD, PUB_CONEMAIL,PUB_TYPE,IF(T.KEY_NAME=1,T.KEY_NAME,T.KEY_NAME) PUB_TYPEDESC, PUB_RUN,IF(RT.KEY_NAME=1,RT.KEY_NAME,RT.KEY_NAME)  PUB_RUNDESC, PUB_LANG,IF(LN.KEY_NAME=1,LN.KEY_NAME,LN.KEY_NAME)  PUB_LANGDESC, PUB_DAYS,PUB_DAY1, PUB_DAY2,DATE_FORMAT(PUB_DT,'%d/%m/%Y')  PUB_DT, PUB_DT_ALL_FLG, MP.CREATION_DT, MP.MAKER,MP.MAKER_DT, \
					MP.STATUS,DT.DIST_NAME  DIST_CDDESC,IF(MTC.CMP_NAME=1,MTC.CMP_NAME,MTC.CMP_NAME)  CMP_CODEDESC,IF(MPC.KEY_NAME=1,MPC.KEY_NAME,MPC.KEY_NAME)  COUNTRYDESC,IF(MPS.KEY_NAME=1,MPS.KEY_NAME,MPS.KEY_NAME)  STATEDESC,IF(MC.KEY_NAME=1,MC.KEY_NAME,MC.KEY_NAME)  CITYDESC, COUPON_COPY_FLAG,PUB_BASE_SUP \
					FROM @DB_NAME.MT_PUBLICATION MP \
					JOIN @DB_NAME.MT_COMPANY MTC ON MP.CMP_CODE=MTC.CMP_CODE \
					JOIN @DB_NAME.ST_DISTRIBUTOR DT ON MP.DIST_CD=DT.DIST_CD \
					LEFT JOIN @DB_NAME.ST_MAPPINGS MPC ON MP.COUNTRY=MPC.KEY_CODE AND 'COUNTRY' = MPC.KEY_TYPE \
					LEFT JOIN @DB_NAME.ST_MAPPINGS MPS ON MP.STATE=MPS.KEY_CODE AND MP.COUNTRY= MPS.KEY_TYPE \
					LEFT JOIN @DB_NAME.ST_MAPPINGS MC ON MP.CITY=MC.KEY_CODE AND MP.STATE = MC.KEY_TYPE \
					LEFT JOIN @DB_NAME.ST_MAPPINGS LN ON MP.PUB_LANG=LN.KEY_CODE AND 'LANGUAGE'= LN.KEY_TYPE \
					LEFT JOIN @DB_NAME.ST_MAPPINGS RT ON MP.PUB_RUN=RT.KEY_CODE AND 'RUN_TYPE'= RT.KEY_TYPE \
					LEFT JOIN @DB_NAME.ST_MAPPINGS T ON MP.PUB_TYPE=T.KEY_CODE AND 'PUB_TYPE'= T.KEY_TYPE \
					WHERE MP.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' AND 
					  
DistApp_DBProcess.formDetails.MT_PURRATE=SELECT R.*,DATE_FORMAT(CONCAT(DATE_FORMAT(LAST_DAY(DATE_ADD(IFNULL(LAST_BILL_DT,CUTOVER_BILL_DT),INTERVAL 1 MONTH)),'%Y-%M-'),'01'),'%A') AS FIRSTDAY FROM @DB_NAME.MT_PURRATE R, @DB_NAME.ST_BILL WHERE R.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' AND 
  
DistApp_DBProcess.formDetails.MT_RATE=SELECT R.*,DATE_FORMAT(CONCAT(DATE_FORMAT(LAST_DAY(DATE_ADD(IFNULL(LAST_BILL_DT,CUTOVER_BILL_DT),INTERVAL 1 MONTH)),'%Y-%M-'),'01'),'%A') AS FIRSTDAY FROM @DB_NAME.MT_RATE R, @DB_NAME.ST_BILL WHERE R.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' AND 
   
DistApp_DBProcess.formDetails.MT_ROUTE=SELECT ROUTE_CODE, NAME, R.CMP_CODE, C.CMP_NAME AS CMP_CODEDESC, MAR_NAME, ST_PNT, ED_PNT, TRAN_MODE, T.KEY_NAME AS TRAN_MODEDESC,
					VAN_NO,RPT_TIME, ARV_TIME, DISTANCE, RATEPERKM, RATE_MONTHLY, TIME, VALID_FLG,SR_NO \
					FROM @DB_NAME.MT_ROUTE R \
					JOIN @DB_NAME.MT_COMPANY C ON R.CMP_CODE = C.CMP_CODE \
					LEFT JOIN @DB_NAME.ST_MAPPINGS T ON R.TRAN_MODE = T.KEY_CODE AND 'TRNS_TYPE' = T.KEY \
					WHERE R.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' AND 
					  
DistApp_DBProcess.formDetails.MT_SUPCHRG=SELECT R.*,DATE_FORMAT(CONCAT(DATE_FORMAT(LAST_DAY(DATE_ADD(IFNULL(LAST_BILL_DT,CUTOVER_BILL_DT),INTERVAL 1 MONTH)),'%Y-%M-'),'01'),'%A') AS FIRSTDAY FROM @DB_NAME.MT_SUPCHRG R, @DB_NAME.ST_BILL WHERE R.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' AND 
  
DistApp_DBProcess.formDetails.RPT_GEN=SELECT PROCESS_STATUS AS STATUS FROM GN_PROCESS_INFO WHERE LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' AND  

DistApp_DBProcess.formDetails.ST_USER=SELECT * FROM @DB_NAME.ST_USER WHERE LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' AND 
  
DistApp_DBProcess.formDetails.TR_DAILY_UNSOLD=SELECT AGN_NAME AS AGN_CODEDESC, CONCAT(DATE_FORMAT(CURDATE(),'%Y%m%d'),(SELECT IFNULL(MAX(SUBSTR(UCN_CNNO,-6))+1,'000001') FROM  TR_DAILY_UNSOLD)) AS UCN_CNNO FROM @DB_NAME.MT_AGENCY WHERE LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' AND 
  
DistApp_DBProcess.formDetails.TR_DAILY_UNSOLDVIEW=SELECT U.UCN_CNNO,U.SUP_DAY,U.RET_COMM, DATE_FORMAT(U.UCN_CREATION_DT,'%d/%m/%Y') AS UCN_CREATION_DT, DATE_FORMAT(U.SUP_DT,'%d/%m/%Y') AS SUP_DT,P.PUB_CODE, P.PUB_NAME, U.RATE, U.RETURN_REASON, U.TOTAL_SUP, U.RETURN_COPY, U.RET_TOTAL_AMT, U.COMM, U.TOTAL_SUP,U.NET_AMT, A.AGN_NAME AS AGN_CODEDESC FROM @DB_NAME.TR_DAILY_UNSOLD U, @DB_NAME.MT_AGENCY A, @DB_NAME.MT_PUBLICATION P WHERE U.AGN_CODE = A.AGN_CODE AND U.PUB_CODE=P.PUB_CODE AND A.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' AND 
  
DistApp_DBProcess.formDetails.TR_PAY_DETAILS=SELECT A.AGN_NAME AS AGN_CODEDESC, CONCAT(DATE_FORMAT(CURDATE(),'%Y%m%d'),(SELECT IFNULL(MAX(SUBSTR(RCD_NO,-6))+1,'000001') FROM TR_PAY_DETAILS)) AS RCD_NO, T.KEY_CODE AS PYMT_TYPE , T.KEY_NAME AS PYMT_TYPEDESC, M.KEY_CODE AS PYMT_MODE , M.KEY_NAME AS PYMT_MODEDESC FROM @DB_NAME.MT_AGENCY A, @DB_NAME.ST_MAPPINGS T, @DB_NAME.ST_MAPPINGS M WHERE T.KEY_TYPE = 'PYMT_TYPE' AND M.KEY_TYPE = 'PYMT_MODE' AND T.KEY_CODE = 'N' AND M.KEY_CODE = 'C' AND A.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' AND 
  
DistApp_DBProcess.formDetails.TR_PAY_DETAILSVIEW=SELECT RCD_NO, P.AGN_CODE, A.AGN_NAME  AGN_CODEDESC, V.KEY_CODE VOU_TYPE, V.KEY_NAME AS VOU_TYPEDESC,DATE_FORMAT(P.RCD_DATE,'%d/%m/%Y') AS RCD_DATE , DATE_FORMAT(P.ENT_DATE,'%d/%m/%Y') AS ENT_DATE , P.ENT_NO,   T.KEY_CODE AS PYMT_TYPE, T.KEY_NAME AS PYMT_TYPEDESC,M.KEY_CODE AS PYMT_MODE, M.KEY_NAME AS PYMT_MODEDESC,  REC_AMOUNT, P.CHQ_NO, DATE_FORMAT(P.CHQ_DATE,'%d/%m/%Y') AS CHQ_DATE , P.BANK_NAME, P.NARRATION FROM @DB_NAME.TR_PAY_DETAILS P, @DB_NAME.ST_MAPPINGS V, @DB_NAME.ST_MAPPINGS T, @DB_NAME.ST_MAPPINGS M, @DB_NAME.MT_AGENCY A WHERE P.AGN_CODE = A.AGN_CODE AND V.KEY_TYPE= 'VOU_TYPE' AND V.KEY_CODE = VOU_TYPE AND T.KEY_TYPE= 'PYMT_TYPE' AND T.KEY_CODE = PYMT_TYPE AND M.KEY_TYPE= 'PYMT_MODE' AND M.KEY_CODE = PYMT_MODE AND A.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' AND 

PersonService.getPersonsForBill.Email=SELECT AGN_CODE,AGN_NAME,LOGIN_USR_VENDOR_ID,AGN_MAR_NAME,AGN_MOB FROM @DB_NAME.MT_AGENCY where lower(LOGIN_USR_VENDOR_ID) = ? and AGN_MAR_NAME IS NOT NULL AND (ROUTE_CODE = ? OR 'ALL' = ?) AND (DLV_CODE = ? OR 'ALL' = ?) AND (AGN_CODE = ? OR 'ALL' = ?)

PersonService.getPersonsForBill.Sms=SELECT AGN_CODE,AGN_NAME,LOGIN_USR_VENDOR_ID,AGN_MAR_NAME,AGN_MOB FROM @DB_NAME.MT_AGENCY where lower(LOGIN_USR_VENDOR_ID) = ? and AGN_MOB IS NOT NULL AND (ROUTE_CODE = ? OR 'ALL' = ?) AND (DLV_CODE = ? OR 'ALL' = ?) AND (AGN_CODE = ? OR 'ALL' = ?)
   
PersonService.updatePendingMails=UPDATE VENDOR_DETAILS set PENDING_EMAIL_COUNT = ? where lower(VENDOR_ID) = ?

PersonService.updatePendingSMS=UPDATE VENDOR_DETAILS set PENDING_SMS_COUNT = ? where lower(VENDOR_ID) = ?

AppService.searchCustomers=SELECT C.AGN_CODE AGN_CODE, C.AGN_NAME AGN_NAME, D.NAME SOCIETY, C.FLAT_NO FLAT, C.WING_NO WING, R.NAME ROUTE FROM @DB_NAME.MT_AGENCY C, @DB_NAME.MT_DELIVERY D, @DB_NAME.MT_ROUTE R WHERE C.DLV_CODE = D.DLV_CODE AND C.ROUTE_CODE = R.ROUTE_CODE AND D.NAME LIKE ? AND C.FLAT_NO LIKE ? AND C.LOGIN_USR_VENDOR_ID = D.LOGIN_USR_VENDOR_ID AND D.LOGIN_USR_VENDOR_ID = R.LOGIN_USR_VENDOR_ID AND C.LOGIN_USR_VENDOR_ID = ? limit 0, 12

PersonService.companyContact=SELECT CMP_TEL, CMP_CONTEL  FROM @DB_NAME.MT_COMPANY WHERE  (CMP_TEL IS NOT NULL OR CMP_CONTEL IS NOT NULL ) and lower(LOGIN_USR_VENDOR_ID) = ? 

AppService.getCustomerPaymentData=SELECT BILL_DATE,BILL_AMT,REC_AMOUNT,ADJUST_AMT,PEND_AMOUNT, PYMT_MODE,CHQ_NO,CHQ_DATE,BANK_NAME,REMARKS,MODE,PAY_REC_DT, AGN_CODE,SOCIETY,ROUTE,FLAT_NO,WING_NO,AGN_NAME \
									FROM ((SELECT DATE_FORMAT(BILL_GEN_DT,'%d/%m/%Y') AS BILL_DATE,BILL_AMT,REC_AMOUNT,IFNULL(ADJUST_AMT,0) AS ADJUST_AMT,(IF(REC_AMOUNT=0,BILL_AMT,PEND_AMOUNT)) AS PEND_AMOUNT, PYMT_MODE,CHQ_NO,DATE_FORMAT(CHQ_DATE,'%d/%m/%Y') CHQ_DATE,BANK_NAME,P.REMARKS,IFNULL(BILL_DATE,'E'), 'MOD' MODE,DATE_FORMAT(PAY_REC_DT,'%d/%m/%Y') PAY_REC_DT, A.AGN_CODE, D.NAME AS SOCIETY, R.NAME AS ROUTE, A.FLAT_NO, A.WING_NO, A.AGN_NAME FROM @DB_NAME.TR_PAYCASH_DETAILS P, @DB_NAME.MT_AGENCY A, @DB_NAME.MT_ROUTE R, @DB_NAME.MT_DELIVERY D WHERE A.AGN_CODE=P.AGN_CODE AND A.AGN_CODE=? \
									AND A.DLV_CODE = D.DLV_CODE AND A.ROUTE_CODE= R.ROUTE_CODE AND P.LOGIN_USR_VENDOR_ID=A.LOGIN_USR_VENDOR_ID AND R.LOGIN_USR_VENDOR_ID=A.LOGIN_USR_VENDOR_ID AND D.LOGIN_USR_VENDOR_ID=A.LOGIN_USR_VENDOR_ID AND P.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID'  ORDER BY BILL_GEN_DT DESC LIMIT 1) \
									UNION ALL (SELECT DATE_FORMAT(BILL_DATE,'%d/%m/%Y') AS BILL_DATE,OS_AMT,0,0,OS_AMT,'C','','','','','E', 'INP','', A.AGN_CODE, D.NAME AS SOCIETY, R.NAME AS ROUTE , A.FLAT_NO, A.WING_NO, A.AGN_NAME FROM @DB_NAME.TR_BILL P,@DB_NAME.MT_AGENCY A, @DB_NAME.MT_ROUTE R, @DB_NAME.MT_DELIVERY D  WHERE A.AGN_CODE=P.AGN_CODE  AND A.AGN_CODE=? AND A.AGN_CODE NOT IN(SELECT AGN_CODE FROM @DB_NAME.TR_PAYCASH_DETAILS C WHERE C.AGN_CODE=P.AGN_CODE AND C.BILL_GEN_DT=P.BILL_DATE AND P.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' )  AND A.DLV_CODE = D.DLV_CODE AND A.ROUTE_CODE= R.ROUTE_CODE AND P.LOGIN_USR_VENDOR_ID=A.LOGIN_USR_VENDOR_ID AND R.LOGIN_USR_VENDOR_ID=A.LOGIN_USR_VENDOR_ID AND D.LOGIN_USR_VENDOR_ID=A.LOGIN_USR_VENDOR_ID AND P.LOGIN_USR_VENDOR_ID='@LOGIN_USR_VENDOR_ID' ORDER BY BILL_DATE DESC LIMIT 1)) AS TEMP ORDER BY BILL_DATE DESC LIMIT 1  
				
BillExecutor.updateCopyStart=UPDATE @DB_NAME.MT_AGN_NEWS_PAPER_MAP SET  COPY_START_DATE= (SELECT DATE_ADD(DATE_ADD(LAST_BILL_DT, INTERVAL 1 MONTH), INTERVAL 1 DAY) FROM @DB_NAME.ST_BILL) WHERE AGN_CODE= 1	